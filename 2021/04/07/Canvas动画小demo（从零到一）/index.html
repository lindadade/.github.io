<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    Canvas动画小demo（从零到一） |
    
    林大大的小屋</title>
  
    <link rel="shortcut icon" href="/lindada-blog/fav.svg">
  
  
<link rel="stylesheet" href="/lindada-blog/css/style.css">

  
    
<link rel="stylesheet" href="/lindada-blog/fancybox/jquery.fancybox.min.css">

  
  
<script src="/lindada-blog/js/pace.min.js"></script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/lindada-blog/atom.xml" title="林大大的小屋" type="application/atom+xml">
</head>

<body>
<main class="content">
  <section class="outer">
  <article id="post-Canvas动画小demo（从零到一）" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

    <div class="article-inner">
        
            <header class="article-header">
                
  
    <h1 class="article-title" itemprop="name">
      Canvas动画小demo（从零到一）
    </h1>
  
  




            </header>
            

                
                    <div class="article-meta">
                        <a href="/lindada-blog/2021/04/07/Canvas%E5%8A%A8%E7%94%BB%E5%B0%8Fdemo%EF%BC%88%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80%EF%BC%89/" class="article-date">
  <time datetime="2021-04-07T04:10:28.000Z" itemprop="datePublished">2021-04-07</time>
</a>
                            
                    </div>
                    

                        
                            
    <div class="tocbot"></div>





                                

                                    <div class="article-entry" itemprop="articleBody">
                                        


                                            

                                                
                                                                    <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>因对于 canvas 画布在面试过程中有重复遇见，而自身也仅仅了解和学习过 canvas 的理论知识，那就那就整一个 demo 叭！</p>
<p>对应的文件已经整理上传到自己的仓库啦（全部注释讲解了喔）</p>
<blockquote>
<p><a href="https://gitee.com/lin_daren/the-gorgeous-electronic-clock-of-canvas" target="_blank" rel="noopener">gitee仓库</a></p>
<p><a href="https://github.com/lindadade/the-gorgeous-electronic-clock-of-canvas" target="_blank" rel="noopener">github仓库</a></p>
</blockquote>
<img src="/lindada-blog/2021/04/07/Canvas%E5%8A%A8%E7%94%BB%E5%B0%8Fdemo%EF%BC%88%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80%EF%BC%89/canvas.gif" class>  

<p><strong>跟随 <a href="https://www.imooc.com/video/2493" target="_blank" rel="noopener">imooc 系列课程 </a>学习总结，如果有不清楚的地方，也建议跟我一样从零观看学习喔</strong></p>
<a id="more"></a>

<h1 id="Canvas-基础"><a href="#Canvas-基础" class="headerlink" title="Canvas 基础"></a>Canvas 基础</h1><h2 id="创建-Canvas"><a href="#创建-Canvas" class="headerlink" title="创建 Canvas"></a>创建 Canvas</h2><h3 id="HTML标签"><a href="#HTML标签" class="headerlink" title="HTML标签"></a>HTML标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span> <span class="attr">width</span>=<span class="string">"1024"</span> <span class="attr">height</span>=<span class="string">"768"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid #aaa; display: block; margin: auto auto"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--兼容降错--&gt;</span></span><br><span class="line">	当前浏览器不支持 Canvas，请更换浏览器后再试</span><br><span class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><em>块级元素，默认 350px 宽，150px 高</em></p>
<blockquote>
<p>W3C 指定应利用 width 和 height 来指定大小（画布大小和像素大小）</p>
</blockquote>
<h3 id="Javascript"><a href="#Javascript" class="headerlink" title="Javascript"></a>Javascript</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="comment">// 绘图上下文环境 2D 绘图</span></span><br><span class="line"><span class="keyword">const</span> context = canvas.getContext(<span class="string">'2d'</span>)</span><br></pre></td></tr></table></figure>



<h2 id="Canvas-绘制"><a href="#Canvas-绘制" class="headerlink" title="Canvas 绘制"></a>Canvas 绘制</h2><h3 id="绘制直线"><a href="#绘制直线" class="headerlink" title="绘制直线"></a>绘制直线</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 状态设置 - 以左上角为顶点（0, 0）</span></span><br><span class="line">context.moveTo(<span class="number">100</span>, <span class="number">100</span>)	<span class="comment">// 笔尖移动</span></span><br><span class="line">context.lineTo(<span class="number">700</span>, <span class="number">700</span>)	<span class="comment">// 画笔移动到这点</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 常用属性</span></span><br><span class="line"><span class="comment">// 笔线</span></span><br><span class="line">context.lineWidth = <span class="number">5</span>	<span class="comment">// 线粗</span></span><br><span class="line">context.strokeStyle = <span class="string">'#005588'</span>	<span class="comment">// 线颜色</span></span><br><span class="line"></span><br><span class="line">context.stroke()	<span class="comment">// 开始绘制</span></span><br></pre></td></tr></table></figure>

<h3 id="绘制多边形"><a href="#绘制多边形" class="headerlink" title="绘制多边形"></a>绘制多边形</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 三角形</span></span><br><span class="line">context.moveTo(<span class="number">100</span>, <span class="number">100</span>)	<span class="comment">// 笔尖移动</span></span><br><span class="line">context.lineTo(<span class="number">700</span>, <span class="number">700</span>)	<span class="comment">// 画笔移动到这点</span></span><br><span class="line">context.lineTo(<span class="number">100</span>, <span class="number">700</span>)	<span class="comment">// 画笔移动到这点</span></span><br><span class="line">context.lineTo(<span class="number">100</span>, <span class="number">100</span>)	<span class="comment">// 画笔移动到这点</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 常用属性</span></span><br><span class="line"><span class="comment">// 笔线</span></span><br><span class="line">context.lineWidth = <span class="number">5</span>	<span class="comment">// 线粗</span></span><br><span class="line">context.strokeStyle = <span class="string">'#005588'</span>	<span class="comment">// 线颜色</span></span><br><span class="line"><span class="comment">// 填充</span></span><br><span class="line">context.fillStyle = <span class="string">'rgb(2, 100, 30)'</span>	<span class="comment">// 填充颜色</span></span><br><span class="line">context.fill()	<span class="comment">// 填充</span></span><br><span class="line"></span><br><span class="line">context.stroke()	<span class="comment">// 开始绘制</span></span><br></pre></td></tr></table></figure>

<h3 id="绘制七巧板"><a href="#绘制七巧板" class="headerlink" title="绘制七巧板"></a>绘制七巧板</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 七巧板线条数据</span></span><br><span class="line"><span class="keyword">const</span> tanGram = [</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">800</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">400</span>&#125;], <span class="attr">color</span>: <span class="string">'#caff67'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">400</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">800</span>&#125;], <span class="attr">color</span>: <span class="string">'#67beef'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">800</span>, <span class="attr">y</span>: <span class="number">0</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">800</span>, <span class="attr">y</span>: <span class="number">400</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">600</span>, <span class="attr">y</span>: <span class="number">600</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">600</span>, <span class="attr">y</span>:<span class="number">200</span>&#125;], <span class="attr">color</span>: <span class="string">'#ef3d61'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">600</span>, <span class="attr">y</span>: <span class="number">200</span>&#125;s, &#123;<span class="attr">x</span>: <span class="number">600</span>, <span class="attr">y</span>: <span class="number">600</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">400</span>&#125;], <span class="attr">color</span>: <span class="string">'#f9f51a'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">400</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">600</span>, <span class="attr">y</span>: <span class="number">600</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">800</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">200</span>, <span class="attr">y</span>: <span class="number">600</span>&#125;], <span class="attr">color</span>: <span class="string">'#a594c0'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">200</span>, <span class="attr">y</span>: <span class="number">600</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">800</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">800</span>&#125;], <span class="attr">color</span>: <span class="string">'#fa8ecc'</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">p</span>: [&#123;<span class="attr">x</span>: <span class="number">800</span>, <span class="attr">y</span>: <span class="number">400</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">800</span>, <span class="attr">y</span>: <span class="number">800</span>&#125;, &#123;<span class="attr">x</span>: <span class="number">400</span>, <span class="attr">y</span>: <span class="number">800</span>&#125;], <span class="attr">color</span>: <span class="string">'#f6ca29'</span>&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 七巧板</span></span><br><span class="line">  <span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line">  <span class="comment">// 绘图上下文环境 2D 绘图</span></span><br><span class="line">  <span class="keyword">const</span> context = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line">  <span class="keyword">const</span> len = tanGram.length</span><br><span class="line">  <span class="comment">// 绘画各个多边形</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    draw(tanGram[i], context)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span>(<span class="params">piece, cxt</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 开始绘制</span></span><br><span class="line">  cxt.beginPath();</span><br><span class="line">  cxt.moveTo(piece.p[<span class="number">0</span>].x, piece.p[<span class="number">0</span>].y)</span><br><span class="line">  <span class="keyword">const</span> len = piece.p.length</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</span><br><span class="line">    cxt.lineTo(piece.p[i].x, piece.p[i].y)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 结束绘制</span></span><br><span class="line">  cxt.closePath()</span><br><span class="line">  cxt.fillStyle = piece.color</span><br><span class="line">  cxt.fill()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="绘制弧和圆"><a href="#绘制弧和圆" class="headerlink" title="绘制弧和圆"></a>绘制弧和圆</h3><h4 id="方法属性"><a href="#方法属性" class="headerlink" title="方法属性"></a>方法属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">constext.arc(</span><br><span class="line">	centerx, centery, radius,	<span class="comment">// 圆心原点坐标以及半径的值</span></span><br><span class="line">  startingAngle, endingAngle,	<span class="comment">// 弧度值的范围</span></span><br><span class="line">  anticlockwise = <span class="literal">false</span>	<span class="comment">// 是否顺时针（可选）- 默认 false 以顺时针方向</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="弧"><a href="#弧" class="headerlink" title="弧"></a>弧</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">context.lineWidth = <span class="number">5</span></span><br><span class="line">context.strokeStyle = <span class="string">'#005588'</span></span><br><span class="line">context.arc(<span class="number">300</span>, <span class="number">300</span>, <span class="number">200</span>, <span class="number">0</span>, <span class="number">1.5</span> + <span class="built_in">Math</span>.PI)</span><br><span class="line">context.stroke()</span><br></pre></td></tr></table></figure>

<h4 id="连续弧"><a href="#连续弧" class="headerlink" title="连续弧"></a>连续弧</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">context.lineWidth = <span class="number">5</span></span><br><span class="line">context.strokeStyle = <span class="string">'#005588'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不连续弧</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  context.beginPath()</span><br><span class="line">  context.arc(<span class="number">50</span> + i*<span class="number">100</span>, <span class="number">60</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">2</span>*<span class="built_in">Math</span>.PI*(i+<span class="number">1</span>)/<span class="number">10</span>)</span><br><span class="line">  context.closePath()</span><br><span class="line">  context.stroke()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 连续弧</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  context.beginPath()</span><br><span class="line">  context.arc(<span class="number">50</span> + i*<span class="number">100</span>, <span class="number">180</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">2</span>*<span class="built_in">Math</span>.PI*(i+<span class="number">1</span>)/<span class="number">10</span>)</span><br><span class="line">  context.stroke()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="圆"><a href="#圆" class="headerlink" title="圆"></a>圆</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">context.lineWidth = <span class="number">5</span></span><br><span class="line">context.strokeStyle = <span class="string">'#005588'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  context.beginPath()</span><br><span class="line">  context.arc(<span class="number">50</span> + i*<span class="number">100</span>, <span class="number">60</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">2</span>*<span class="built_in">Math</span>.PI*(i+<span class="number">1</span>)/<span class="number">10</span>)</span><br><span class="line">  context.closePath()</span><br><span class="line">	context.fill()	<span class="comment">// 填充</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  context.beginPath()</span><br><span class="line">  context.arc(<span class="number">50</span> + i*<span class="number">100</span>, <span class="number">180</span>, <span class="number">40</span>, <span class="number">0</span>, <span class="number">2</span>*<span class="built_in">Math</span>.PI*(i+<span class="number">1</span>)/<span class="number">10</span>)</span><br><span class="line">	context.fill()	<span class="comment">// 填充</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="实现电子钟"><a href="#实现电子钟" class="headerlink" title="实现电子钟"></a>实现电子钟</h1><h2 id="绘制电子钟"><a href="#绘制电子钟" class="headerlink" title="绘制电子钟"></a>绘制电子钟</h2><h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><blockquote>
<p> digin.js    // 存放数字的二维点阵</p>
<p> countdown.js    // 具体逻辑</p>
<p> index.html    // 具体页面</p>
</blockquote>
<h4 id="二维点阵-digin-js"><a href="#二维点阵-digin-js" class="headerlink" title="二维点阵 - digin.js"></a>二维点阵 - digin.js</h4><p>因为数据太多，稍微拿一个进行例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 表示 0，1 表示需绘制圆</span></span><br><span class="line">[</span><br><span class="line">  [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">  [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="具体逻辑-countdown-js"><a href="#具体逻辑-countdown-js" class="headerlink" title="具体逻辑 - countdown.js"></a>具体逻辑 - countdown.js</h4><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常量</span></span><br><span class="line"><span class="keyword">const</span> WINDOW_WIDTH = <span class="number">1024</span>;</span><br><span class="line"><span class="keyword">const</span> WINDOW_HEIGHT = <span class="number">768</span>;</span><br><span class="line"><span class="keyword">const</span> RADIUS = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">const</span> MARGIN_TOP = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">const</span> MARGIN_LEFT = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="comment">// 初始化画布</span></span><br><span class="line">    <span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</span><br><span class="line">    <span class="keyword">const</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line"></span><br><span class="line">    canvas.width = WINDOW_WIDTH;</span><br><span class="line">    canvas.height = WINDOW_HEIGHT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绘制方法</span></span><br><span class="line">    render( context )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="绘制圆点"><a href="#绘制圆点" class="headerlink" title="绘制圆点"></a>绘制圆点</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制圆点</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">renderDigit</span>(<span class="params"> x , y , num , cxt </span>)</span>&#123;</span><br><span class="line">    cxt.fillStyle = <span class="string">"rgb(0,102,153)"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; digit[num].length ; i ++ )</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span> ; j &lt; digit[num][i].length ; j ++ )</span><br><span class="line">            <span class="keyword">if</span>( digit[num][i][j] == <span class="number">1</span> )&#123;</span><br><span class="line">                cxt.beginPath();</span><br><span class="line">              	<span class="comment">// 第（i, j）个圆的圆心位置：</span></span><br><span class="line">              	<span class="comment">// j*2*(R+1) =&gt; 第 j 列个的框框</span></span><br><span class="line">              	<span class="comment">// x: x+j*2*(R+1)+(R+1)</span></span><br><span class="line">               	<span class="comment">// y: y+i*2*(R+1)+(R+1)</span></span><br><span class="line">                cxt.arc( x+j*<span class="number">2</span>*(RADIUS+<span class="number">1</span>)+(RADIUS+<span class="number">1</span>) , y+i*<span class="number">2</span>*(RADIUS+<span class="number">1</span>)+(RADIUS+<span class="number">1</span>) , RADIUS , <span class="number">0</span> , <span class="number">2</span>*<span class="built_in">Math</span>.PI )</span><br><span class="line">                cxt.closePath()</span><br><span class="line"></span><br><span class="line">                cxt.fill()</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="绘制数字圆点"><a href="#绘制数字圆点" class="headerlink" title="绘制数字圆点"></a>绘制数字圆点</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制数字的每一个圆点</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"> cxt </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> hours = <span class="number">12</span></span><br><span class="line">		<span class="keyword">let</span> minutes = <span class="number">34</span></span><br><span class="line">		<span class="keyword">let</span> seconds = <span class="number">56</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    renderDigit( MARGIN_LEFT , MARGIN_TOP , <span class="built_in">parseInt</span>(hours/<span class="number">10</span>) , cxt )</span><br><span class="line">  	<span class="comment">// 2</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">15</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(hours%<span class="number">10</span>) , cxt )</span><br><span class="line">  	<span class="comment">// ：</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">30</span>*(RADIUS + <span class="number">1</span>) , MARGIN_TOP , <span class="number">10</span> , cxt )</span><br><span class="line">  	<span class="comment">// 3</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">39</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(minutes/<span class="number">10</span>) , cxt);</span><br><span class="line">  	<span class="comment">// 4</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">54</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(minutes%<span class="number">10</span>) , cxt);</span><br><span class="line">  	<span class="comment">// ：</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">69</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="number">10</span> , cxt);</span><br><span class="line">  	<span class="comment">// 5</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">78</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(seconds/<span class="number">10</span>) , cxt);</span><br><span class="line">  	<span class="comment">// 6</span></span><br><span class="line">    renderDigit( MARGIN_LEFT + <span class="number">93</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(seconds%<span class="number">10</span>) , cxt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="时间计算"><a href="#时间计算" class="headerlink" title="时间计算"></a>时间计算</h3><h4 id="初始化-1"><a href="#初始化-1" class="headerlink" title="初始化"></a>初始化</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 记得动态更改你的截止日期噢</span></span><br><span class="line"><span class="keyword">const</span> endTime = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2021</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">let</span> curShowTimeSeconds = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h4 id="绘制"><a href="#绘制" class="headerlink" title="绘制"></a>绘制</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="comment">// 初始化画布</span></span><br><span class="line">    <span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</span><br><span class="line">    <span class="keyword">const</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line"></span><br><span class="line">    canvas.width = WINDOW_WIDTH;</span><br><span class="line">    canvas.height = WINDOW_HEIGHT;</span><br><span class="line">		curShowTimeSeconds = getCurrentShowTimeSeconds()</span><br><span class="line">		render( context )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="获取时间数字"><a href="#获取时间数字" class="headerlink" title="获取时间数字"></a>获取时间数字</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前时间与截止日期</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentShowTimeSeconds</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> curTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">	<span class="keyword">var</span> ret = endTime.getTime() - curTime.getTime();</span><br><span class="line">	ret = <span class="built_in">Math</span>.round( ret/<span class="number">1000</span> )</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret &gt;= <span class="number">0</span> ? ret : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="绘制数字圆点-1"><a href="#绘制数字圆点-1" class="headerlink" title="绘制数字圆点"></a>绘制数字圆点</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更改值</span></span><br><span class="line"><span class="keyword">let</span> hours = <span class="built_in">parseInt</span>( curShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line"><span class="keyword">let</span> minutes = <span class="built_in">parseInt</span>( (curShowTimeSeconds - hours * <span class="number">3600</span>)/<span class="number">60</span> )</span><br><span class="line"><span class="keyword">let</span> seconds = curShowTimeSeconds % <span class="number">60</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>刷新即可得到当前动态的时间数字</p>
<p>以此实现了电子钟</p>
</blockquote>
<h1 id="实现动画效果"><a href="#实现动画效果" class="headerlink" title="实现动画效果"></a>实现动画效果</h1><h2 id="时钟数字动画"><a href="#时钟数字动画" class="headerlink" title="时钟数字动画"></a>时钟数字动画</h2><h3 id="目录结构-1"><a href="#目录结构-1" class="headerlink" title="目录结构"></a>目录结构</h3><blockquote>
<p> digin.js    // 存放数字的二维点阵</p>
<p> countdown.js    // 具体逻辑</p>
<p> index.html    // 具体页面</p>
</blockquote>
<h3 id="定时渲染"><a href="#定时渲染" class="headerlink" title="定时渲染"></a>定时渲染</h3><p>使用 setInterval() 来渲染动画</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// countdown.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="comment">// 初始化画布</span></span><br><span class="line">    <span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</span><br><span class="line">    <span class="keyword">const</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line"></span><br><span class="line">    canvas.width = WINDOW_WIDTH;</span><br><span class="line">    canvas.height = WINDOW_HEIGHT;</span><br><span class="line">		curShowTimeSeconds = getCurrentShowTimeSeconds()</span><br><span class="line">  	<span class="comment">// 定时渲染</span></span><br><span class="line">		setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      render( context );</span><br><span class="line">      update()	<span class="comment">// 更新函数</span></span><br><span class="line">    &#125;, <span class="number">50</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="更新时钟"><a href="#更新时钟" class="headerlink" title="更新时钟"></a>更新时钟</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 下一秒的时钟</span></span><br><span class="line">  <span class="keyword">const</span> nextShowTimeSeconds = getCurrentShowTimeSeconds()</span><br><span class="line">  <span class="keyword">let</span> nextHours = <span class="built_in">parseInt</span>( nextShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line">	<span class="keyword">let</span> nextMinutes = <span class="built_in">parseInt</span>( (nextShowTimeSeconds - nextHours * <span class="number">3600</span>)/<span class="number">60</span> )</span><br><span class="line">	<span class="keyword">let</span> nextSeconds = nextShowTimeSeconds % <span class="number">60</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 当前秒的时钟</span></span><br><span class="line">  <span class="keyword">let</span> curHours = <span class="built_in">parseInt</span>( curShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line">	<span class="keyword">let</span> curMinutes = <span class="built_in">parseInt</span>( (curShowTimeSeconds - curHours* <span class="number">3600</span>)/<span class="number">60</span> )</span><br><span class="line">	<span class="keyword">let</span> curSeconds = curShowTimeSeconds % <span class="number">60</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 更新秒钟</span></span><br><span class="line">  <span class="keyword">if</span> (nextShowTimeSeconds != curShowTimeSeconds) &#123;</span><br><span class="line">    curShowTimeSeconds = nextShowTimeSeconds</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="更新画布"><a href="#更新画布" class="headerlink" title="更新画布"></a>更新画布</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"> cxt </span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对整个屏幕矩形进行刷新</span></span><br><span class="line">	cxt.clearRect(<span class="number">0</span>, <span class="number">0</span>, WINDOW_WIDTH, WINDOW_HEIGHT)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> hours = <span class="built_in">parseInt</span>( curShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line">	<span class="keyword">let</span> minutes = <span class="built_in">parseInt</span>( (curShowTimeSeconds - hours * <span class="number">3600</span>)/<span class="number">60</span> )</span><br><span class="line">	<span class="keyword">let</span> seconds = curShowTimeSeconds % <span class="number">60</span></span><br><span class="line"></span><br><span class="line">	renderDigit( MARGIN_LEFT , MARGIN_TOP , <span class="built_in">parseInt</span>(hours/<span class="number">10</span>) , cxt )</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">15</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(hours%<span class="number">10</span>) , cxt )</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">30</span>*(RADIUS + <span class="number">1</span>) , MARGIN_TOP , <span class="number">10</span> , cxt )</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">39</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(minutes/<span class="number">10</span>) , cxt);</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">54</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(minutes%<span class="number">10</span>) , cxt);</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">69</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="number">10</span> , cxt);</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">78</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(seconds/<span class="number">10</span>) , cxt);</span><br><span class="line">	renderDigit( MARGIN_LEFT + <span class="number">93</span>*(RADIUS+<span class="number">1</span>) , MARGIN_TOP , <span class="built_in">parseInt</span>(seconds%<span class="number">10</span>) , cxt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="小球动画"><a href="#小球动画" class="headerlink" title="小球动画"></a>小球动画</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span> <span class="attr">width</span>=<span class="string">"1024"</span> <span class="attr">height</span>=<span class="string">"768"</span> <span class="attr">style</span>=<span class="string">"border: 1px solid #aaa; display: block; margin: auto auto"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--兼容降错--&gt;</span></span><br><span class="line">	当前浏览器不支持 Canvas，请更换浏览器后再试</span><br><span class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="comment">// 初始化小球</span></span></span><br><span class="line"><span class="actionscript"><span class="keyword">const</span> ball = &#123; x: <span class="number">512</span>, y: <span class="number">100</span>, r: <span class="number">20</span>, g: <span class="number">2</span>, vx: <span class="number">-4</span>, vy: <span class="number">0</span>, color: <span class="string">'#005588'</span> &#125;</span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span></span><br><span class="line"><span class="actionscript">	<span class="comment">// 绘图上下文环境 2D 绘图</span></span></span><br><span class="line"><span class="actionscript">	<span class="keyword">const</span> context = canvas.getContext(<span class="string">'2d'</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="comment">// 定时器动画</span></span></span><br><span class="line"><span class="javascript">	setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">		<span class="comment">// 渲染</span></span></span><br><span class="line">		render(context)</span><br><span class="line"><span class="actionscript">		<span class="comment">// 更新</span></span></span><br><span class="line">		update()</span><br><span class="line">	&#125;, 50)</span><br><span class="line">&#125;</span><br><span class="line"><span class="actionscript"><span class="comment">// 动画</span></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line">	ball.x += ball.vx</span><br><span class="line">	ball.y += ball.vy</span><br><span class="line">	ball.vy += ball.g</span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="comment">// 碰撞底部</span></span></span><br><span class="line">	if (ball.y &gt;= 768 - ball.r) &#123;</span><br><span class="line">		ball.y = 768 - ball.r</span><br><span class="line"><span class="actionscript">		ball.vy = -ball.vy*<span class="number">0.6</span>	<span class="comment">// 摩擦力</span></span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">(ctx)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">	<span class="comment">// 刷新 canvas 画布</span></span></span><br><span class="line">	ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)</span><br><span class="line">	ctx.fillStyle = ball.color</span><br><span class="line">	ctx.beginPath()</span><br><span class="line"><span class="javascript">	ctx.arc(ball.x, ball.y, ball.r, <span class="number">0</span>, <span class="number">2</span>*<span class="built_in">Math</span>.PI)</span></span><br><span class="line">	ctx.closePath()</span><br><span class="line">	ctx.fill()</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="时钟小球动画"><a href="#时钟小球动画" class="headerlink" title="时钟小球动画"></a>时钟小球动画</h2><h3 id="目录结构-2"><a href="#目录结构-2" class="headerlink" title="目录结构"></a>目录结构</h3><blockquote>
<p> digin.js    // 存放数字的二维点阵</p>
<p> countdown.js    // 具体逻辑</p>
<p> index.html    // 具体页面</p>
</blockquote>
<h3 id="初始化数据"><a href="#初始化数据" class="headerlink" title="初始化数据"></a>初始化数据</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常量</span></span><br><span class="line"><span class="keyword">const</span> WINDOW_WIDTH = <span class="number">1024</span>;</span><br><span class="line"><span class="keyword">const</span> WINDOW_HEIGHT = <span class="number">768</span>;</span><br><span class="line"><span class="keyword">const</span> RADIUS = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">const</span> MARGIN_TOP = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">const</span> MARGIN_LEFT = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> endTime = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2021</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">let</span> curShowTimeSeconds = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 存放小球</span></span><br><span class="line"><span class="keyword">const</span> balls = [];</span><br><span class="line"><span class="comment">// 更换颜色</span></span><br><span class="line"><span class="keyword">const</span> colors = [<span class="string">"#33B5E5"</span>,<span class="string">"#0099CC"</span>,<span class="string">"#AA66CC"</span>,<span class="string">"#9933CC"</span>,<span class="string">"#99CC00"</span>,<span class="string">"#669900"</span>,<span class="string">"#FFBB33"</span>,<span class="string">"#FF8800"</span>,<span class="string">"#FF4444"</span>,<span class="string">"#CC0000"</span>]</span><br></pre></td></tr></table></figure>

<h3 id="更新小球"><a href="#更新小球" class="headerlink" title="更新小球"></a>更新小球</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// 下一秒的时钟</span></span><br><span class="line">	<span class="keyword">const</span> nextShowTimeSeconds = getCurrentShowTimeSeconds()</span><br><span class="line">	<span class="keyword">let</span> nextHours = <span class="built_in">parseInt</span>(nextShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line">	<span class="keyword">let</span> nextMinutes = <span class="built_in">parseInt</span>((nextShowTimeSeconds - nextHours * <span class="number">3600</span>) / <span class="number">60</span>)</span><br><span class="line">	<span class="keyword">let</span> nextSeconds = nextShowTimeSeconds % <span class="number">60</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 当前秒的时钟</span></span><br><span class="line">	<span class="keyword">let</span> curHours = <span class="built_in">parseInt</span>(curShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line">	<span class="keyword">let</span> curMinutes = <span class="built_in">parseInt</span>((curShowTimeSeconds - curHours * <span class="number">3600</span>) / <span class="number">60</span>)</span><br><span class="line">	<span class="keyword">let</span> curSeconds = curShowTimeSeconds % <span class="number">60</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 更新秒钟</span></span><br><span class="line">	<span class="keyword">if</span> (nextShowTimeSeconds != curShowTimeSeconds) &#123;</span><br><span class="line">    <span class="comment">// 对 6 个数字一起判断更新</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(curHours / <span class="number">10</span>) != <span class="built_in">parseInt</span>(nextHours / <span class="number">10</span>)) &#123;</span><br><span class="line">      <span class="comment">// 添加小球</span></span><br><span class="line">			addBalls(MARGIN_LEFT + <span class="number">0</span>, MARGIN_TOP, <span class="built_in">parseInt</span>(curHours / <span class="number">10</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(curHours % <span class="number">10</span>) != <span class="built_in">parseInt</span>(nextHours % <span class="number">10</span>)) &#123;</span><br><span class="line">			addBalls(MARGIN_LEFT + <span class="number">15</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(curHours / <span class="number">10</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(curMinutes / <span class="number">10</span>) != <span class="built_in">parseInt</span>(nextMinutes / <span class="number">10</span>)) &#123;</span><br><span class="line">			addBalls(MARGIN_LEFT + <span class="number">39</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(curMinutes / <span class="number">10</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(curMinutes % <span class="number">10</span>) != <span class="built_in">parseInt</span>(nextMinutes % <span class="number">10</span>)) &#123;</span><br><span class="line">			addBalls(MARGIN_LEFT + <span class="number">54</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(curMinutes % <span class="number">10</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(curSeconds / <span class="number">10</span>) != <span class="built_in">parseInt</span>(nextSeconds / <span class="number">10</span>)) &#123;</span><br><span class="line">			addBalls(MARGIN_LEFT + <span class="number">78</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(curSeconds / <span class="number">10</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">parseInt</span>(curSeconds % <span class="number">10</span>) != <span class="built_in">parseInt</span>(nextSeconds % <span class="number">10</span>)) &#123;</span><br><span class="line">			addBalls(MARGIN_LEFT + <span class="number">93</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(nextSeconds % <span class="number">10</span>));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		curShowTimeSeconds = nextShowTimeSeconds;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 更新球</span></span><br><span class="line">	updateBalls();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="添加小球"><a href="#添加小球" class="headerlink" title="添加小球"></a>添加小球</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加小球</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addBalls</span>(<span class="params">x, y, num</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; digit[num].length; i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; digit[num][i].length; j++)</span><br><span class="line">			<span class="keyword">if</span> (digit[num][i][j] == <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">const</span> aBall = &#123;</span><br><span class="line">          <span class="comment">// 原点</span></span><br><span class="line">					x: x + j * <span class="number">2</span> * (RADIUS + <span class="number">1</span>) + (RADIUS + <span class="number">1</span>),</span><br><span class="line">					y: y + i * <span class="number">2</span> * (RADIUS + <span class="number">1</span>) + (RADIUS + <span class="number">1</span>),</span><br><span class="line">          <span class="comment">// 动画随机设计</span></span><br><span class="line">					g: <span class="number">1.5</span> + <span class="built_in">Math</span>.random(),</span><br><span class="line">					vx: <span class="built_in">Math</span>.pow(<span class="number">-1</span>, <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random() * <span class="number">1000</span>)) * <span class="number">4</span>,</span><br><span class="line">					vy: <span class="number">-5</span>,</span><br><span class="line">					color: colors[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * colors.length)]</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				balls.push(aBall)</span><br><span class="line">			&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="更新小球运动"><a href="#更新小球运动" class="headerlink" title="更新小球运动"></a>更新小球运动</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新小球运动</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateBalls</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; balls.length; i++) &#123;</span><br><span class="line">		balls[i].x += balls[i].vx;</span><br><span class="line">		balls[i].y += balls[i].vy;</span><br><span class="line">		balls[i].vy += balls[i].g;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 碰撞检测</span></span><br><span class="line">		<span class="keyword">if</span> (balls[i].y &gt;= WINDOW_HEIGHT - RADIUS) &#123;</span><br><span class="line">			balls[i].y = WINDOW_HEIGHT - RADIUS;</span><br><span class="line">			balls[i].vy = -balls[i].vy * <span class="number">0.75</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="绘制小球"><a href="#绘制小球" class="headerlink" title="绘制小球"></a>绘制小球</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制数字的每一个圆点</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">cxt</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 对整个屏幕矩形进行刷新</span></span><br><span class="line">	cxt.clearRect(<span class="number">0</span>, <span class="number">0</span>, WINDOW_WIDTH, WINDOW_HEIGHT)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> hours = <span class="built_in">parseInt</span>(curShowTimeSeconds / <span class="number">3600</span>);</span><br><span class="line">	<span class="keyword">let</span> minutes = <span class="built_in">parseInt</span>((curShowTimeSeconds - hours * <span class="number">3600</span>) / <span class="number">60</span>)</span><br><span class="line">	<span class="keyword">let</span> seconds = curShowTimeSeconds % <span class="number">60</span></span><br><span class="line"></span><br><span class="line">	renderDigit(MARGIN_LEFT, MARGIN_TOP, <span class="built_in">parseInt</span>(hours / <span class="number">10</span>), cxt)</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">15</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(hours % <span class="number">10</span>), cxt)</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">30</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="number">10</span>, cxt)</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">39</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(minutes / <span class="number">10</span>), cxt);</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">54</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(minutes % <span class="number">10</span>), cxt);</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">69</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="number">10</span>, cxt);</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">78</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(seconds / <span class="number">10</span>), cxt);</span><br><span class="line">	renderDigit(MARGIN_LEFT + <span class="number">93</span> * (RADIUS + <span class="number">1</span>), MARGIN_TOP, <span class="built_in">parseInt</span>(seconds % <span class="number">10</span>), cxt);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 绘制小球</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; balls.length; i++) &#123;</span><br><span class="line">		cxt.fillStyle = balls[i].color;</span><br><span class="line"></span><br><span class="line">		cxt.beginPath();</span><br><span class="line">		cxt.arc(balls[i].x, balls[i].y, RADIUS, <span class="number">0</span>, <span class="number">2</span> * <span class="built_in">Math</span>.PI, <span class="literal">true</span>);</span><br><span class="line">		cxt.closePath();</span><br><span class="line"></span><br><span class="line">		cxt.fill();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="优化、扩展时钟"><a href="#优化、扩展时钟" class="headerlink" title="优化、扩展时钟"></a>优化、扩展时钟</h1><h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><h3 id="目录结构-3"><a href="#目录结构-3" class="headerlink" title="目录结构"></a>目录结构</h3><blockquote>
<p> digin.js    // 存放数字的二维点阵</p>
<p> countdown.js    // 具体逻辑</p>
<p> index.html    // 具体页面</p>
</blockquote>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><blockquote>
<p>问题：balls 的数组在不断地增加，终究会有极限。</p>
</blockquote>
<blockquote>
<p>解决：当小球运动出 canvas 画布时，应该删除掉对应的小球。</p>
<p>该小球数组应只存在画布出现的小球（会越来越慢和卡）</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新小球运动</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateBalls</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; balls.length; i++) &#123;</span><br><span class="line">		balls[i].x += balls[i].vx;</span><br><span class="line">		balls[i].y += balls[i].vy;</span><br><span class="line">		balls[i].vy += balls[i].g;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (balls[i].y &gt;= WINDOW_HEIGHT - RADIUS) &#123;</span><br><span class="line">			balls[i].y = WINDOW_HEIGHT - RADIUS;</span><br><span class="line">			balls[i].vy = -balls[i].vy * <span class="number">0.75</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数量初始化为 0 =&gt; 确立还有多少个小球保留在画布中</span></span><br><span class="line">	<span class="keyword">let</span> cnt = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span>( <span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; balls.length ; i ++ )</span><br><span class="line">    <span class="comment">// 是否在画布中</span></span><br><span class="line">		<span class="keyword">if</span>( balls[i].x + RADIUS &gt; <span class="number">0</span> &amp;&amp; balls[i].x -RADIUS &lt; WINDOW_WIDTH )</span><br><span class="line">      <span class="comment">// 是则添加小球</span></span><br><span class="line">			balls[cnt++] = balls[i]</span><br><span class="line">	<span class="comment">// 只保留存在画布的小球</span></span><br><span class="line">	<span class="keyword">while</span>( balls.length &gt; cnt )&#123;</span><br><span class="line">		balls.pop();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="屏幕自适应"><a href="#屏幕自适应" class="headerlink" title="屏幕自适应"></a>屏幕自适应</h2><p>让初始化的常量根据当前屏幕来自适应即可。</p>
<blockquote>
<p>将 DOM 元素宽高撑起来以便获取</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">style</span>=<span class="string">"height: 100%;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">"height: 100%;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span> <span class="attr">style</span>=<span class="string">"height: 100%;"</span>&gt;</span></span><br><span class="line">        当前浏览器不支持Canvas，请更换浏览器后再试</span><br><span class="line">    <span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"digit.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"countdown.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>动态定义画布初始化变量</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// countdown.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 常量</span></span><br><span class="line"><span class="keyword">let</span> WINDOW_WIDTH = <span class="number">1024</span>;</span><br><span class="line"><span class="keyword">let</span> WINDOW_HEIGHT = <span class="number">768</span>;</span><br><span class="line"><span class="keyword">let</span> RADIUS = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">let</span> MARGIN_TOP = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">let</span> MARGIN_LEFT = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> endTime = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">let</span> curShowTimeSeconds = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 存放小球</span></span><br><span class="line"><span class="keyword">const</span> balls = [];</span><br><span class="line"><span class="comment">// 更换颜色</span></span><br><span class="line"><span class="keyword">const</span> colors = [<span class="string">"#33B5E5"</span>, <span class="string">"#0099CC"</span>, <span class="string">"#AA66CC"</span>, <span class="string">"#9933CC"</span>, <span class="string">"#99CC00"</span>, <span class="string">"#669900"</span>, <span class="string">"#FFBB33"</span>, <span class="string">"#FF8800"</span>, <span class="string">"#FF4444"</span>, <span class="string">"#CC0000"</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 根据用户屏幕来自定义常量</span></span><br><span class="line">  WINDOW_WIDTH = <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line">  WINDOW_HEIGHT = <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">  MARGIN_LEFT = <span class="built_in">Math</span>.round(WINDOW_WIDTH/<span class="number">10</span>);</span><br><span class="line">  <span class="comment">// 根据 renderDigit 的 x 来进行判断</span></span><br><span class="line">  RADIUS = <span class="built_in">Math</span>.round(WINDOW_WIDTH * <span class="number">4</span> / <span class="number">5</span> / <span class="number">108</span>)<span class="number">-1</span></span><br><span class="line">  MARGIN_TOP = <span class="built_in">Math</span>.round(WINDOW_HEIGHT / <span class="number">5</span>)</span><br><span class="line">  </span><br><span class="line">	<span class="comment">// 初始化画布</span></span><br><span class="line">	<span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</span><br><span class="line">	<span class="keyword">const</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line"></span><br><span class="line">	canvas.width = WINDOW_WIDTH;</span><br><span class="line">	canvas.height = WINDOW_HEIGHT;</span><br><span class="line">	curShowTimeSeconds = getCurrentShowTimeSeconds()</span><br><span class="line">	<span class="comment">// 定时渲染</span></span><br><span class="line">	setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">		render(context);</span><br><span class="line">		update()	<span class="comment">// 更新函数</span></span><br><span class="line">	&#125;, <span class="number">50</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="归零时间更新"><a href="#归零时间更新" class="headerlink" title="归零时间更新"></a>归零时间更新</h2><blockquote>
<p>问题：若定义的 endTime 至今小于 99 个小时 =&gt; 则返回 00:00:00</p>
</blockquote>
<blockquote>
<p>解决：动态获取 endTime</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当前时间增加一小时</span></span><br><span class="line"><span class="keyword">let</span> endTime = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">endTime.setTime(endTime.getTime() + <span class="number">3600</span> * <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<h2 id="绚丽时钟效果"><a href="#绚丽时钟效果" class="headerlink" title="绚丽时钟效果"></a>绚丽时钟效果</h2><p>可以来做当前时钟的效果，不止是倒计时</p>
<blockquote>
<p>重点在 getCurrentShowTimeSecond() 中，返回今天已经走过了多久即可。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前时间</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentShowTimeSeconds</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> curTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="comment">// 存的是今天已经走过了多久 =&gt; 时钟</span></span><br><span class="line">	<span class="keyword">let</span> ret = curTime.getHours() * <span class="number">3600</span> + curTime.getMinutes() * <span class="number">60</span> + curTime.getSeconds()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>放上 <a href="https://www.canvasapi.cn/" target="_blank" rel="noopener">canvas Api</a></p>
<p>以下将本次学习课程中使用常见的方法和属性再次整理回顾。</p>
<h2 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h2><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><ul>
<li><canvas id="canvas"></canvas></li>
</ul>
<h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><ul>
<li><pre><code class="js"><span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)    <span class="comment">// 获取 canvas 元素</span>
<span class="keyword">const</span> context = canvas.getContext(<span class="string">'2d'</span>)    <span class="comment">// 获取上下文来进行绘制</span>
&lt;!--￼<span class="number">31</span>--&gt;</code></pre>
</li>
<li><p>常用方法</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前画布的上下文</span></span><br><span class="line">canvas.getContext(<span class="string">'2d'</span>)</span><br></pre></td></tr></table></figure>





<h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><ul>
<li>常用属性</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 笔线宽</span></span><br><span class="line">context.lineWidth</span><br><span class="line"></span><br><span class="line"><span class="comment">// 笔线颜色</span></span><br><span class="line">context.strokeStyle</span><br><span class="line"></span><br><span class="line"><span class="comment">// 填充色</span></span><br><span class="line">context.fillStyle</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该上下文对应的 canvas 画布</span></span><br><span class="line">context.canvas</span><br></pre></td></tr></table></figure>

<ul>
<li>常用方法</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 移动笔尖</span></span><br><span class="line">context.moveTo(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 画线</span></span><br><span class="line">context.lineTo(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 画弧</span></span><br><span class="line">context.arc(cx, cy, r, sAng, eAng, anticlock = <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始描绘</span></span><br><span class="line">context.beginPath()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结束描绘</span></span><br><span class="line">context.closePath()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制笔线颜色</span></span><br><span class="line">context.stroke()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 填充颜色</span></span><br><span class="line">context.fill()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 刷新矩形区域</span></span><br><span class="line">context.clearRect(x, y, width, height)</span><br></pre></td></tr></table></figure>

<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>加油～</p>
<p>整理自己的前端体系架构，然后找到一个好实习！</p>

                                                                        
                                    </div>
                                    <footer class="article-footer">
                                        
                                            <!--MOB SHARE BEGIN-->
<a><div class="-mob-share-open article-share-link">分享</div></a>
<div class="-mob-share-ui" style="display: none; display: flex; align-items: center; align-content: center;">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-tencentweibo"><p>腾讯微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
    </ul>
    <div style="height: 100%; width: 100%">
        <div class="-mob-share-close" style="position:relative; margin: -26em auto; width: 80px; height: 40px; font-size: 14px; color: #fff; background-color: #4593e9; border-radius: 15px;">取消</div>
    </div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="/lindada-blog/js/mob-share.js"></script>
<!--MOB SHARE END-->

                                        
                                        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/lindada-blog/tags/Canvas%E5%B0%8F%E5%B1%8B/" rel="tag">Canvas小屋</a></li></ul>

                                    </footer>

    </div>

    
        
  <nav class="article-nav">
    
      <a href="/lindada-blog/2021/04/13/%EF%BC%88%E7%BB%A7%E6%89%BF%EF%BC%89%E6%88%91%E4%B8%80%E5%AD%97%E4%B8%80%E8%A1%8C%E5%9C%B0%E9%87%8D%E8%AF%BB%E7%BA%A2%E5%AE%9D%E4%B9%A6/" class="article-nav-link">
        <strong class="article-nav-caption">前一篇</strong>
        <div class="article-nav-title">
          
            （继承）我一字一行地重读红宝书
          
        </div>
      </a>
    
    
      <a href="/lindada-blog/2021/03/03/%EF%BC%88%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%89%E6%88%91%E4%B8%80%E5%AD%97%E4%B8%80%E8%A1%8C%E5%9C%B0%E9%87%8D%E8%AF%BB%E7%BA%A2%E5%AE%9D%E4%B9%A6/" class="article-nav-link">
        <strong class="article-nav-caption">后一篇</strong>
        <div class="article-nav-title">（第三章）我一字一行地重读红宝书</div>
      </a>
    
  </nav>


            

                
                    
    <div class="vcomments" id="vcomments"></div>
    
<script src="https://unpkg.com/valine/dist/Valine.min.js"></script>

        <script>
            new Valine({
                el: '#vcomments',
                appId: 'vtOOBRQNx6g17peggpfzBROa-9Nh9j0Va',
                appKey: 'Q1DgaTCfUeYjMOqoTAH8TX9M',
                notify: 'false',
                verify: 'true',
                avatar: 'mp',
                pageSize: '15',
                placeholder: '✨悄悄地对小屋说...'
            })
        </script>
        
                        
                            

</article>

</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li>访客数 <i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
    <li>阅读量 <i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>

    </div>
    <ul class="list-inline">
      <li>&copy; 2021 林大大的小屋</li> |
      <li> Gitee主页 by <a href="https://gitee.com/lin_daren" target="_blank">林大大的Gitee</a></li> |
      <li> Wechat by <span class="footer-title">dadaLin_0809</span></li>
      <li> Email by <span class="footer-title">809751956@qq.com</span></li> |
    </ul>
  </div>
</footer>

<style>
    .footer-title {
        color: darkcyan;
        font-weight: bold;
    }
</style>

</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/lindada-blog/"><img src="/lindada-blog/images/star.svg" alt="林大大的小屋"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/lindada-blog/">主页</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/lindada-blog/archives">归档</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/lindada-blog/gallery">相册</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/lindada-blog/about">关于</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="搜索">
        <i class="fe fe-search"></i>
        搜索
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/lindada-blog/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>

<script src="/lindada-blog/js/jquery-2.0.3.min.js"></script>


<script src="/lindada-blog/js/jquery.justifiedGallery.min.js"></script>


<script src="/lindada-blog/js/lazyload.min.js"></script>


<script src="/lindada-blog/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/lindada-blog/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/lindada-blog/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>



<script src="/lindada-blog/js/ocean.js"></script>


<script src="/lindada-blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/lindada-blog/live2dw/assets/assets/shizuku.model.json"},"display":{"position":"left","width":180,"height":360,"top":"-40px","right":"25px"},"mobile":{"show":true}});</script></body>
</html>
